import React from 'react';

type RemarkType = 'success' | 'warning' | 'danger' | 'info' | 'secondary';

interface HarmonyStats {
  subject: string;
  harmonyRatio: number;
  remark: string;
  remarkType: RemarkType;
}

const HarmonyPrintableAnalysis: React.FC<{ stats: HarmonyStats[] }> = ({ stats }) => {
  if (stats.length === 0) return null;

  const total = stats.reduce((sum, s) => sum + s.harmonyRatio, 0);
  const averageHarmony = +(total / stats.length).toFixed(2);

  let level = "";
  let paragraph1 = "";
  let paragraph2 = "";
  let recommendation = "";

  if (averageHarmony <= 15) {
    level = "هناك إنسجام تام";
    paragraph1 = `
تشير المعطيات إلى أن نسبة الإنسجام بين التلاميذ منخفضة (≈ ${averageHarmony} بالمئة)، وهو ما يُصنف ضمن المستوى ${level} من حيث التقارب في النتائج.
هذا المؤشر يُعدّ إيجابيًا على المستوى البيداغوجي، حيث يعكس تقاربًا عامًا في مستوى الفهم والتحصيل بين أغلب التلاميذ، مما يُسهم في استقرار دينامية القسم ويُسهل عمليات التعليم والتعلم.`;

    paragraph2 = `
هذا التقارب قد يكون ناتجًا عن استراتيجيات تدريس فعّالة تمكّنت من تقليص الفوارق، أو نتيجة تجانس في الخلفيات المعرفية للمتعلمين. 
ورغم الإيجابية الظاهرة، إلا أنه من الضروري الانتباه لاحتمال وجود افتقاد للتحدي لدى الفئات المتفوقة، مما يستدعي فتح مسارات تعليمية إضافية لهذه الفئة لضمان استمرار نموّها.`;

    recommendation = `
يُوصى بمواصلة تعزيز الممارسات التعليمية التي ساهمت في هذا الإنسجام، مع الحرص على إدماج أنشطة إثرائية موجهة للتلاميذ ذوي الأداء العالي، وتكثيف استخدام التقويمات التكوينية لاستباق أي تراجع في التوازن العام.`;
  } else if (averageHarmony <= 30) {
    level = "هناك إنسجام نسبي";
    paragraph1 = `
بلغت نسبة الإنسجام بين التلاميذ حوالي ${averageHarmony} بالمئة، مما يضعها ضمن المستوى ${level}. 
هذا التفاوت النسبي في النتائج يعكس وجود اختلافات محدودة في مستوى الفهم والتحصيل بين المتعلمين، وهو أمر طبيعي في الأقسام الدراسية.`;

    paragraph2 = `
تُظهر هذه المعطيات أن القسم يحتضن تلاميذ بمستويات متعددة تتراوح بين المقبول والجيد، وهو ما يقتضي من المدرّس اعتماد استراتيجيات تدريس متنوعة وتفريقية لضمان استيعاب الجميع.
كما أن هذا النمط من الإنسجام يتيح فرصًا لتنمية روح التعاون بين التلاميذ، وتعزيز التعلم التشاركي.`;

    recommendation = `
من المستحسن تقوية التنسيق بين أعضاء الفريق التربوي لاعتماد خطط تعليمية مرنة تستجيب لهذه الفروقات، مع تفعيل ورشات الدعم والتقوية للفئات المتعثرة،
وتوفير تحديات معرفية ملائمة للفئات المتقدمة بما يعزز تماسك القسم دون المساس بجودة التحصيل.`;
  } else {
    level = "هناك تشتت واختلاف";
    paragraph1 = `
تُظهر البيانات أن نسبة الإنسجام مرتفعة نسبيًا، حيث بلغت ${averageHarmony} بالمئة، وهو ما يُصنف ضمن المستوى ${level}، أي وجود تباين كبير في نتائج التلاميذ.`;

    paragraph2 = `
هذا التفاوت يشير إلى وجود فجوات معرفية كبيرة داخل القسم، تُؤثر سلبًا على التفاعل الصفي وتُصعب من مهام التدريس الفعّال.
وقد يكون ذلك مرتبطًا بعوامل متعددة مثل الفروق الفردية، أو قصور في استراتيجيات الدعم، أو ضعف التنسيق البيداغوجي.`;

    recommendation = `
ينبغي التدخل العاجل عبر تفعيل حصص المعالجة التربوية الفردية والجماعية، 
وتبني تقويمات تشخيصية دقيقة لرصد مكامن الضعف، بالإضافة إلى تفعيل خطط الدعم الموجه وتطوير التكامل بين الأساتذة لمواجهة هذا التباين.`;
  }

  return (
    <div id="harmonyStatsAnalysis" className="hidden-printable">
      <h3 className="text-lg font-bold mb-6">التحليل النوعي العام لنسبة الإنسجام بين التلاميذ</h3>

      <div className="whitespace-pre-line leading-8 space-y-4 text-right">

        <p>{paragraph1}</p>

        <p>{paragraph2}</p>

        <p className="mt-2">{recommendation}</p>
      </div>
    </div>
  );
};

export default HarmonyPrintableAnalysis;